# /c/Users/USER/development/celery_framework/src/config/config.yaml
app:
  name: "celery_framework"
  version: "1.0.0"
  environment: ${APP_ENV:local}

celery:
  broker_url: "redis://localhost:6379/0"
  result_backend: "redis://localhost:6379/1"
  task_serializer: "json"
  result_serializer: "json"
  accept_content:
    - json
  timezone: "Asia/Kolkata"
  enable_utc: true

worker:
  prefetch_multiplier: 1
  max_tasks_per_child: 50

task:
  track_started: true
  time_limit: 1800
  soft_time_limit: 1500
  result_expires: 3600

# Task source configuration
tasks:
  source: "database"  # Change to "config" to use task_list below

  # Database source (used when source: "database")
  database:
    uri: "sqlite:///tasks.db"
    table: "tasks"

  # Config source (used when source: "config")
  # Define tasks directly in YAML
  task_list:
    - name: "tasks.add"
      module_path: "tasks.example_tasks"
      function_name: "add"
      description: "Add two numbers"
      enabled: true
      tags:
        - math
        - celery
      options:
        bind: true
        max_retries: 3
        retry_backoff: true
      metadata:
        author: "dev team"
        version: "1.0"

    - name: "tasks.multiply"
      module_path: "tasks.example_tasks"
      function_name: "multiply"
      description: "Multiply two numbers"
      enabled: true
      tags:
        - math
        - celery
      options:
        time_limit: 60
      metadata:
        complexity: "low"

    - name: "tasks.process_data"
      module_path: "tasks.example_tasks"
      function_name: "process_data"
      description: "Process data batch"
      enabled: true
      tags:
        - data
        - celery
        - batch
      options:
        time_limit: 300
        soft_time_limit: 250
        max_retries: 5
      metadata:
        batch_size: 1000
        priority: "high"

    - name: "tasks.send_email"
      module_path: "tasks.notification_tasks"
      function_name: "send_email"
      description: "Send email notification"
      enabled: false  # Disabled task
      tags:
        - notification
        - email
      options:
        bind: true
        max_retries: 3
        retry_backoff: true
        autoretry_for:
          - "ConnectionError"
          - "TimeoutError"